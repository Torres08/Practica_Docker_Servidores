# Imagen base
FROM ubuntu:latest

# Permite que la instalación se realice sin requerir la selección de la ubicación geográfica
ENV DEBIAN_FRONTEND=noninteractive

# Actualiza el sistema y instala las dependencias necesarias
RUN apt-get update && apt-get install -y \
    php \
    apache2 \
    libapache2-mod-php \
    curl \
    && rm -rf /var/lib/apt/lists/*
RUN apt-get update && apt-get install -y zip unzip git
RUN apt-get install -y iputils-ping && apt install -y iproute2 

# Activar SSL y crear directorio para copiar certificados
RUN a2enmod ssl && mkdir /etc/apache2/ssl 

# Modifica el archivo de configuración de Apache para usar los certificados "certificado_juanlu.crt" y "certificado_juanlu.key" creados con el comando:
# openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout ./certificado_juanlu.key -out ./certificado_juanlu.crt

#Copiamos un archivo con una configuración de SSL --- rutas de los certificados
COPY ./juanlu-apache-ssl.conf /etc/apache2/sites-available/juanlu-apache-ssl.conf

# activa el sitio default-ssl
RUN a2ensite juanlu-apache-ssl.conf

# Exponer puertos para Apache, 80 y 443
EXPOSE 80 443

# Comando para iniciar Apache al iniciar el contenedor
CMD apache2ctl -D FOREGROUND && tail -f /dev/null




